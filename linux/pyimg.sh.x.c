#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f pyimg.sh -o pyimg 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[2]))
	"\154\234\344\064\363\243\152\360\260\041\040\153\145\321\230\016"
	"\007\257\124\136\326\233\201\242"
#define      tst2_z	19
#define      tst2	((&data[26]))
	"\122\341\062\337\237\015\032\326\220\264\120\105\373\150\017\270"
	"\344\016\236\371\276\134\163\330\314"
#define      tst1_z	22
#define      tst1	((&data[51]))
	"\264\224\157\170\042\120\207\017\317\330\113\257\350\243\010\163"
	"\171\042\327\273\065\376\306\222\063\256\324"
#define      inlo_z	3
#define      inlo	((&data[76]))
	"\165\132\250"
#define      xecc_z	15
#define      xecc	((&data[82]))
	"\354\102\141\251\230\015\234\335\134\360\066\344\323\257\067\300"
	"\110\211\131\336"
#define      chk2_z	19
#define      chk2	((&data[103]))
	"\347\126\144\071\352\166\127\164\167\175\075\314\126\242\013\025"
	"\101\272\021\074\113\001\370\067\301"
#define      rlax_z	1
#define      rlax	((&data[124]))
	"\370"
#define      date_z	1
#define      date	((&data[125]))
	"\107"
#define      pswd_z	256
#define      pswd	((&data[132]))
	"\215\357\250\330\376\370\164\063\132\153\327\347\263\226\133\043"
	"\000\030\050\376\327\301\374\225\275\043\060\140\163\375\026\214"
	"\052\334\021\224\320\205\307\052\361\236\022\244\064\155\307\065"
	"\206\357\063\136\261\057\363\157\122\043\317\306\040\345\122\112"
	"\301\144\336\221\351\246\274\333\104\316\177\171\074\106\256\302"
	"\066\342\040\350\022\024\130\145\067\047\053\130\015\176\243\317"
	"\342\202\141\314\050\035\247\155\354\046\347\050\155\226\352\244"
	"\170\013\214\212\037\345\357\127\014\033\260\032\231\124\351\174"
	"\327\113\110\377\150\357\155\124\026\124\175\203\353\147\047\143"
	"\163\264\356\222\231\336\352\246\371\233\301\223\357\252\017\306"
	"\365\127\306\136\106\064\263\135\211\060\340\164\230\010\330\013"
	"\275\307\236\127\245\210\376\236\044\277\061\024\152\101\333\140"
	"\230\241\276\337\326\162\074\137\242\035\324\072\045\255\105\343"
	"\164\343\072\031\154\070\270\221\367\352\245\141\053\200\301\303"
	"\042\200\243\371\362\337\131\225\374\055\317\042\332\025\006\116"
	"\371\100\150\146\170\040\367\160\012\235\322\066\035\224\371\100"
	"\024\235\071\007\174\222\241\237\345\343\001\077\302\376\032\103"
	"\346\160\250\037\250\151\314\271\367\370\100\044\327\133"
#define      chk1_z	22
#define      chk1	((&data[414]))
	"\055\075\354\020\043\341\033\110\200\127\242\244\316\162\127\265"
	"\313\347\260\120\167\047\246\074\111"
#define      shll_z	10
#define      shll	((&data[439]))
	"\014\302\006\301\055\012\252\314\221\101\343\061\352\113"
#define      opts_z	1
#define      opts	((&data[451]))
	"\373"
#define      text_z	5606
#define      text	((&data[1586]))
	"\160\357\177\332\274\070\321\264\171\366\213\324\173\360\037\251"
	"\056\151\317\015\122\334\317\074\050\123\045\216\034\365\145\214"
	"\344\344\147\240\035\071\124\226\057\340\152\252\321\212\123\377"
	"\363\043\014\105\000\334\202\050\060\250\267\114\235\034\331\201"
	"\000\100\042\035\171\167\264\251\127\036\123\050\251\247\047\235"
	"\313\064\342\313\021\145\364\101\015\253\216\253\307\147\055\310"
	"\250\117\346\042\306\232\313\036\271\037\106\142\307\156\377\222"
	"\243\342\135\264\110\121\366\126\375\204\001\304\354\057\215\225"
	"\177\163\270\106\015\203\144\307\243\253\052\153\032\052\375\275"
	"\014\133\162\125\255\151\253\252\356\255\157\333\334\374\160\133"
	"\157\050\241\175\254\006\104\120\261\157\273\313\231\271\211\246"
	"\024\374\373\301\145\246\154\124\123\333\057\060\327\237\213\106"
	"\310\055\304\164\063\011\304\345\170\200\260\021\071\072\267\115"
	"\067\263\017\235\132\173\361\256\127\040\336\056\300\152\165\210"
	"\227\071\375\313\102\301\260\272\102\141\314\173\233\204\310\323"
	"\067\330\160\222\124\141\100\253\202\036\331\102\210\116\313\040"
	"\207\310\353\312\212\234\205\314\375\121\107\231\326\020\154\016"
	"\350\334\240\075\076\340\350\300\376\302\003\207\020\317\247\230"
	"\227\223\142\041\057\350\356\054\071\065\306\020\106\062\036\057"
	"\017\276\154\116\236\125\016\235\027\022\045\047\341\315\300\171"
	"\140\043\233\220\013\211\275\105\277\203\125\005\266\163\065\306"
	"\061\241\024\320\366\043\156\015\065\223\065\027\140\365\220\301"
	"\031\053\122\044\265\017\151\164\223\276\172\112\061\260\020\143"
	"\121\044\064\110\107\242\126\175\066\214\224\227\202\045\131\233"
	"\121\253\277\006\273\051\173\116\347\366\230\031\246\250\175\370"
	"\315\261\100\024\124\227\221\212\044\046\041\246\113\172\101\234"
	"\046\001\242\341\052\036\057\022\024\310\054\272\161\251\263\076"
	"\133\364\123\257\213\345\071\260\013\133\126\126\326\230\362\374"
	"\232\225\335\305\264\015\330\310\325\004\203\107\256\066\205\011"
	"\052\331\271\266\276\363\146\311\116\275\040\044\125\023\041\360"
	"\250\376\265\135\014\215\045\342\221\251\051\100\340\257\111\012"
	"\210\003\301\106\366\047\020\104\344\060\151\072\103\213\052\354"
	"\211\340\111\226\155\157\170\377\030\242\077\370\121\211\003\332"
	"\214\305\041\202\354\061\307\321\142\061\014\246\274\067\222\106"
	"\027\334\334\204\113\125\204\144\367\303\135\111\115\141\043\331"
	"\046\105\134\023\167\043\345\331\125\361\177\021\051\022\130\100"
	"\356\064\305\072\212\111\236\201\015\374\313\132\135\356\063\203"
	"\064\217\227\253\263\174\205\010\156\005\032\227\027\162\327\006"
	"\247\235\100\061\346\337\262\363\333\176\115\070\154\201\274\241"
	"\021\123\114\304\317\322\315\075\327\347\325\357\131\255\365\000"
	"\112\066\061\061\025\344\044\360\142\162\051\317\364\345\161\006"
	"\071\275\312\010\220\230\106\147\177\033\127\331\311\115\332\023"
	"\203\013\104\230\360\151\211\123\334\262\043\321\227\224\327\320"
	"\122\242\331\342\072\040\112\272\074\242\223\005\357\155\030\162"
	"\171\135\012\152\307\223\275\243\106\341\164\336\165\114\256\310"
	"\356\210\252\050\250\365\343\345\227\166\352\206\344\003\371\136"
	"\140\003\310\047\227\206\313\336\147\100\274\335\214\153\245\172"
	"\363\120\243\234\106\206\201\335\375\154\144\341\157\135\077\320"
	"\141\010\370\371\216\303\327\366\003\223\324\220\376\172\012\362"
	"\312\256\216\020\064\020\356\061\174\123\023\354\260\123\274\022"
	"\133\264\013\352\170\343\340\174\166\265\014\165\057\027\147\371"
	"\305\366\012\372\007\371\054\204\114\077\160\375\222\054\017\356"
	"\341\033\330\131\376\270\325\165\156\341\353\235\371\123\227\277"
	"\112\242\271\121\233\345\325\350\045\106\346\267\162\366\246\124"
	"\021\176\255\020\067\203\205\245\144\161\102\136\304\331\035\016"
	"\173\326\137\027\274\065\000\342\173\346\232\356\334\100\103\356"
	"\276\360\376\365\163\204\232\330\365\335\066\272\266\124\310\062"
	"\053\050\112\350\136\112\312\332\061\144\311\016\244\014\374\142"
	"\375\373\127\160\200\362\111\166\317\200\060\206\324\371\271\000"
	"\042\003\350\200\116\262\133\177\026\044\215\272\061\212\034\056"
	"\206\164\237\006\147\350\175\066\151\256\275\076\247\166\076\312"
	"\171\046\113\307\330\246\107\356\313\325\250\374\137\305\052\346"
	"\071\311\355\241\262\152\327\034\031\225\132\301\013\230\213\205"
	"\277\326\115\227\174\224\206\107\151\057\103\311\364\156\257\056"
	"\070\235\317\353\007\247\007\040\074\141\341\110\372\155\315\271"
	"\103\032\120\300\256\326\010\030\006\114\342\372\272\222\051\362"
	"\057\371\335\066\240\345\127\335\106\071\045\100\246\362\371\351"
	"\015\112\252\274\040\262\325\046\376\267\041\270\111\113\253\170"
	"\104\211\257\345\156\007\302\265\100\350\365\347\333\357\321\350"
	"\071\173\245\132\055\172\201\054\061\242\344\173\356\220\364\062"
	"\032\243\030\210\253\332\076\354\303\063\323\236\042\244\234\334"
	"\230\167\103\077\323\275\023\276\051\121\241\011\243\065\364\115"
	"\050\021\272\003\046\026\020\027\227\345\364\061\252\244\323\037"
	"\270\377\112\057\142\112\233\325\074\016\053\337\204\101\105\064"
	"\134\001\332\233\235\073\112\310\247\377\177\211\254\000\260\150"
	"\315\132\005\351\076\073\323\122\003\302\235\374\371\347\013\066"
	"\031\015\355\056\374\164\027\373\136\150\176\127\034\322\351\042"
	"\144\323\065\267\332\017\021\200\052\250\275\257\355\041\047\025"
	"\066\177\244\032\214\042\305\030\111\233\007\235\131\217\023\042"
	"\014\020\154\171\045\264\156\322\147\073\034\322\233\243\002\232"
	"\115\341\155\123\207\176\206\047\061\262\120\021\154\017\111\060"
	"\177\232\052\036\265\062\160\032\321\355\321\045\146\056\347\371"
	"\037\106\073\216\011\257\230\337\113\212\157\373\310\113\035\305"
	"\145\061\300\011\250\011\016\143\024\326\050\067\273\264\347\214"
	"\065\043\053\242\052\137\151\366\114\013\237\062\122\161\064\122"
	"\201\063\130\103\371\000\031\321\164\243\364\316\332\153\102\062"
	"\132\156\166\101\235\121\333\303\010\070\150\327\170\176\134\172"
	"\012\247\341\261\134\357\254\126\065\230\032\164\370\220\036\266"
	"\312\045\203\347\045\222\277\071\103\001\173\201\341\132\210\013"
	"\135\203\037\240\132\005\336\275\134\347\351\237\372\231\046\274"
	"\173\342\134\242\200\045\177\074\131\044\236\305\340\056\151\014"
	"\240\216\371\315\174\271\256\317\017\155\014\203\036\115\157\107"
	"\242\364\013\370\030\056\347\106\310\164\064\070\347\215\354\265"
	"\035\174\062\235\022\027\320\115\351\205\040\155\016\123\244\175"
	"\272\040\163\045\366\243\271\040\350\060\032\277\031\205\133\344"
	"\004\165\076\144\043\262\363\156\057\134\335\203\065\044\017\312"
	"\236\023\065\166\371\200\212\366\314\002\072\272\377\363\226\330"
	"\266\224\056\166\155\012\356\357\037\132\346\272\054\017\107\142"
	"\060\345\070\354\200\070\077\240\135\334\342\362\314\371\274\171"
	"\240\072\055\355\377\322\123\122\324\114\200\112\317\254\271\113"
	"\012\364\114\041\111\374\350\030\047\100\011\061\266\233\210\154"
	"\360\047\005\353\334\367\256\237\362\361\321\040\013\145\177\133"
	"\224\063\077\277\040\172\350\077\237\071\327\245\256\053\356\072"
	"\351\006\232\010\357\260\323\241\060\016\363\225\326\322\061\267"
	"\276\325\216\276\303\263\000\366\216\071\147\055\236\106\016\126"
	"\166\216\335\311\260\017\362\107\213\023\254\325\111\264\301\011"
	"\266\276\305\242\362\320\006\307\222\105\362\040\202\152\160\242"
	"\275\171\175\033\150\347\361\230\260\215\027\065\243\234\032\063"
	"\245\023\023\226\141\103\375\333\112\122\021\200\050\231\262\057"
	"\126\271\023\366\015\141\020\350\150\246\005\056\127\117\244\225"
	"\126\162\261\071\044\202\143\033\261\167\242\300\052\322\364\255"
	"\004\271\230\212\013\276\321\154\236\352\004\114\200\105\355\220"
	"\360\241\263\157\317\352\236\047\114\342\357\327\122\355\067\004"
	"\336\376\276\153\143\266\126\257\111\302\345\312\074\342\122\334"
	"\337\252\200\165\033\136\241\341\346\373\070\365\274\334\027\251"
	"\277\073\206\276\346\042\322\033\327\312\001\073\037\365\127\300"
	"\025\271\115\276\123\360\260\122\255\375\114\014\203\254\222\253"
	"\317\112\326\134\366\044\114\067\100\326\113\277\075\024\001\215"
	"\355\137\071\266\370\222\233\300\327\054\371\361\106\204\001\277"
	"\025\222\167\360\211\204\137\012\272\113\040\372\177\317\001\311"
	"\037\216\146\156\212\161\343\166\132\060\354\340\003\056\015\145"
	"\175\356\324\376\377\066\270\250\051\220\121\152\335\323\254\072"
	"\375\221\310\250\072\051\063\077\046\134\325\010\065\213\362\152"
	"\030\072\032\355\234\157\123\045\221\113\100\033\324\127\033\343"
	"\020\264\304\362\141\314\072\273\231\301\251\253\322\302\100\153"
	"\173\051\022\314\346\201\343\225\052\275\331\344\145\223\223\073"
	"\205\075\277\033\123\232\127\313\233\026\177\177\375\053\131\142"
	"\012\267\040\220\306\237\241\261\010\121\126\010\231\227\164\315"
	"\141\241\021\103\345\120\336\321\104\273\211\043\325\017\345\363"
	"\242\276\320\157\211\073\365\275\363\254\207\273\255\067\232\017"
	"\301\206\105\032\266\164\231\106\125\377\236\260\120\314\113\022"
	"\074\023\371\356\212\157\273\211\032\200\145\003\254\165\077\240"
	"\160\165\127\067\340\212\005\214\102\322\207\157\107\031\261\242"
	"\010\104\246\131\067\071\157\343\352\124\343\327\236\303\233\271"
	"\044\053\303\206\203\073\047\112\064\125\125\272\024\365\102\064"
	"\347\275\224\122\253\053\121\244\360\240\241\125\306\270\375\002"
	"\133\102\047\377\317\362\204\167\034\340\357\336\177\140\300\130"
	"\254\337\073\103\147\122\074\362\106\220\202\353\337\067\010\225"
	"\036\040\375\074\343\375\016\203\057\206\204\040\376\130\056\331"
	"\175\065\141\055\164\306\174\000\002\360\131\134\121\305\062\336"
	"\127\370\244\234\013\052\235\165\365\104\206\112\070\354\312\317"
	"\046\161\370\034\365\260\126\373\204\160\050\162\126\014\247\273"
	"\013\145\254\114\162\131\362\145\374\232\150\200\172\171\120\010"
	"\163\075\077\275\133\222\214\367\376\067\113\031\156\373\025\103"
	"\043\213\001\211\201\364\341\247\367\030\214\244\227\106\310\322"
	"\255\014\130\144\174\371\056\236\034\255\032\306\047\056\313\377"
	"\071\125\131\174\307\141\362\157\315\321\223\370\176\163\267\255"
	"\140\103\343\212\305\016\163\056\112\014\145\171\134\224\177\365"
	"\332\145\023\012\027\234\314\352\070\104\043\215\225\307\032\354"
	"\161\176\234\365\376\267\363\227\326\111\031\201\110\314\251\236"
	"\131\322\114\135\037\066\312\017\142\314\331\206\167\055\074\255"
	"\350\227\324\153\354\057\370\350\041\330\222\042\145\161\065\076"
	"\277\274\370\233\365\006\220\362\172\034\354\323\065\021\301\010"
	"\270\130\044\261\347\322\312\326\200\022\313\366\056\003\007\200"
	"\155\021\022\152\311\061\237\116\341\324\357\046\326\306\163\177"
	"\351\055\170\014\006\103\151\331\031\112\110\361\263\071\337\075"
	"\351\301\263\110\022\100\341\111\211\040\367\011\160\101\024\101"
	"\263\201\321\053\112\206\243\236\206\273\313\345\111\037\032\333"
	"\111\223\255\322\046\364\176\335\105\251\255\255\310\041\112\027"
	"\121\246\313\046\016\023\226\007\225\373\147\250\035\005\162\151"
	"\243\244\131\201\122\164\354\217\272\361\361\351\375\102\310\307"
	"\046\025\333\223\371\322\170\134\274\211\344\267\124\325\270\236"
	"\251\043\211\017\126\375\235\174\025\246\155\120\353\171\004\044"
	"\233\170\263\242\150\274\371\223\124\166\014\330\226\123\017\350"
	"\317\024\136\152\312\040\305\103\263\260\230\123\125\304\332\300"
	"\206\316\136\155\000\072\031\015\212\101\366\212\304\061\141\346"
	"\006\164\333\136\234\051\202\365\177\041\041\164\246\322\265\017"
	"\033\350\227\251\211\004\055\176\252\161\156\142\236\010\350\222"
	"\102\244\215\214\302\355\120\023\350\010\247\133\056\311\247\122"
	"\032\303\346\255\006\074\342\350\017\234\263\363\221\001\113\003"
	"\064\262\252\203\366\025\070\236\122\237\115\075\111\206\331\221"
	"\054\315\325\067\045\072\232\246\264\144\023\255\172\265\321\001"
	"\160\070\361\315\335\157\300\331\201\354\055\021\340\134\056\330"
	"\065\312\022\363\111\120\061\062\023\143\100\303\204\323\371\143"
	"\263\230\233\242\236\207\230\242\354\207\167\163\321\010\132\100"
	"\013\017\037\267\323\076\026\254\306\056\075\063\035\017\056\240"
	"\066\360\142\150\107\214\327\352\152\111\215\160\004\072\200\003"
	"\112\123\250\266\325\171\014\051\203\016\046\003\156\246\234\054"
	"\273\160\226\145\304\174\362\305\240\171\060\142\211\213\330\127"
	"\074\005\275\226\154\224\207\167\113\121\163\160\310\156\256\332"
	"\005\167\310\064\244\041\251\366\326\064\216\366\354\101\114\100"
	"\133\104\174\253\206\113\205\166\250\364\135\221\142\234\033\040"
	"\272\011\223\267\260\047\216\340\001\346\346\156\242\372\231\372"
	"\351\005\011\100\027\237\315\245\133\367\117\205\370\075\027\142"
	"\354\105\051\303\026\201\255\174\331\362\231\046\223\221\243\205"
	"\105\215\361\376\251\257\263\113\333\056\317\235\053\267\075\070"
	"\247\156\052\253\056\054\230\366\027\313\367\215\377\337\212\037"
	"\244\337\146\375\277\100\123\306\122\031\367\302\221\241\002\114"
	"\124\225\056\340\004\235\111\322\043\261\341\025\154\042\125\234"
	"\215\007\375\151\054\113\323\066\201\136\351\071\116\023\125\277"
	"\057\343\103\027\302\325\312\247\015\242\242\373\276\357\261\123"
	"\352\305\373\037\314\140\101\117\043\253\300\114\261\227\167\204"
	"\022\377\205\017\102\234\220\041\076\212\352\322\260\153\067\213"
	"\374\155\031\354\001\015\102\212\175\116\055\051\317\042\315\272"
	"\066\175\004\007\140\337\120\276\032\126\114\202\144\341\112\014"
	"\012\363\305\313\325\017\241\040\171\246\267\130\175\251\006\320"
	"\102\367\043\165\045\347\347\212\212\366\074\241\364\352\172\020"
	"\326\033\054\246\170\157\337\025\030\374\123\000\077\155\376\017"
	"\176\320\155\036\216\237\077\257\232\012\033\022\174\066\370\231"
	"\045\001\313\164\357\113\042\007\003\155\316\212\277\317\212\377"
	"\364\144\245\130\017\312\063\002\341\066\367\133\375\071\331\252"
	"\160\066\073\100\060\236\333\272\306\011\302\157\200\024\101\322"
	"\145\340\211\310\042\016\270\202\301\356\213\367\261\057\375\134"
	"\220\107\050\367\025\175\342\341\071\222\246\114\317\147\046\233"
	"\365\067\275\043\066\362\103\341\204\014\021\113\104\320\245\273"
	"\314\226\062\340\327\036\143\241\221\211\151\220\317\067\334\103"
	"\213\062\156\261\140\001\123\056\330\134\344\331\213\017\363\164"
	"\362\046\331\144\271\333\120\312\101\342\114\276\261\215\201\326"
	"\022\143\227\173\313\102\074\135\166\013\061\257\164\206\066\342"
	"\357\037\073\224\317\065\257\114\002\214\267\275\247\126\057\141"
	"\013\303\336\132\360\074\261\315\214\001\166\370\257\075\047\156"
	"\143\217\146\156\101\000\374\010\211\075\341\341\015\140\326\321"
	"\004\066\123\146\231\107\240\344\330\310\263\055\021\166\030\131"
	"\067\134\306\367\142\141\013\054\253\070\116\154\033\202\267\137"
	"\162\272\320\224\250\066\006\010\327\372\116\271\346\330\213\061"
	"\314\262\146\144\334\213\104\154\364\140\046\110\367\152\054\207"
	"\312\356\066\364\373\271\236\316\155\202\334\132\036\106\254\232"
	"\375\267\163\322\354\137\277\320\167\153\222\076\217\035\162\175"
	"\056\377\331\110\067\004\170\354\114\325\001\051\262\303\076\042"
	"\073\275\372\133\105\053\067\242\006\011\142\345\260\357\226\373"
	"\277\127\233\037\211\321\245\201\376\037\045\176\015\017\001\023"
	"\257\332\173\252\274\102\176\172\175\001\246\216\276\376\102\075"
	"\070\102\313\251\151\352\011\337\300\114\365\046\136\012\327\227"
	"\171\210\106\362\362\265\333\035\253\273\051\301\057\235\217\141"
	"\125\271\127\133\207\262\102\055\175\114\175\150\161\371\132\162"
	"\155\050\257\327\303\306\347\002\043\232\123\312\117\367\035\052"
	"\140\034\161\243\304\025\076\277\146\074\211\121\030\046\277\015"
	"\113\066\372\353\304\255\230\230\361\273\163\242\377\365\072\346"
	"\054\275\343\212\176\003\312\237\141\323\225\076\155\345\331\164"
	"\040\110\241\322\371\023\223\107\253\242\230\062\017\044\216\320"
	"\023\252\260\261\107\330\153\360\232\156\001\002\217\174\213\123"
	"\336\310\057\332\106\211\144\232\107\151\242\033\100\202\224\106"
	"\200\253\030\001\214\334\231\053\076\113\055\211\233\254\351\362"
	"\166\162\317\347\157\331\226\127\320\261\071\177\350\245\217\372"
	"\076\206\342\305\332\205\355\145\323\161\100\106\016\147\310\237"
	"\060\212\257\225\023\120\040\023\122\323\047\320\066\324\143\322"
	"\054\232\173\252\071\133\230\234\201\273\007\146\266\117\312\105"
	"\374\202\332\371\036\325\224\247\304\117\226\302\076\375\040\320"
	"\263\152\355\345\224\056\041\301\251\266\050\312\332\337\165\156"
	"\366\262\244\111\166\346\132\352\377\013\346\321\036\370\207\334"
	"\172\030\133\201\154\256\104\342\144\154\312\310\125\356\261\333"
	"\124\241\336\226\025\211\255\225\060\131\161\272\023\032\207\074"
	"\116\014\054\111\125\173\370\222\265\216\356\325\171\361\056\362"
	"\374\040\103\276\312\365\306\144\017\011\265\207\354\104\320\351"
	"\345\061\236\224\104\215\062\206\365\055\230\130\074\366\226\255"
	"\075\312\342\323\013\066\073\310\274\151\263\322\053\136\235\341"
	"\165\217\271\102\203\005\340\377\111\212\313\362\025\245\020\324"
	"\236\021\254\340\152\272\174\012\042\024\250\033\000\222\064\035"
	"\047\041\245\110\327\061\211\312\073\234\252\324\155\306\337\140"
	"\323\356\036\025\246\170\240\075\141\270\327\106\224\021\076\302"
	"\201\056\261\026\060\137\314\013\004\275\363\156\213\366\045\261"
	"\054\026\201\020\304\065\076\141\033\073\053\065\257\275\301\004"
	"\323\142\170\273\211\300\345\325\132\265\174\104\000\007\222\355"
	"\207\254\351\263\145\112\015\122\216\055\060\343\040\136\156\171"
	"\032\230\315\254\161\351\107\321\172\174\066\341\340\262\063\012"
	"\111\260\224\107\253\254\375\063\260\223\251\030\075\247\315\315"
	"\366\165\376\011\255\264\346\102\061\307\157\016\367\332\107\141"
	"\106\026\033\273\336\250\274\302\201\171\173\001\345\263\271\021"
	"\342\311\014\247\274\044\012\371\364\276\073\053\106\300\222\263"
	"\254\000\243\234\223\130\331\101\044\371\347\252\233\373\006\316"
	"\243\227\246\327\351\366\062\264\376\313\327\074\333\016\205\166"
	"\060\146\010\070\175\065\131\131\130\234\377\166\341\035\050\160"
	"\315\206\172\255\127\325\257\067\137\340\355\376\075\242\265\106"
	"\331\131\243\027\150\064\111\342\000\046\374\325\331\261\166\122"
	"\017\344\230\347\247\114\167\311\300\057\214\042\222\040\010\045"
	"\034\201\153\306\026\352\143\377\123\060\217\246\323\262\001\352"
	"\104\052\152\363\355\115\057\303\120\236\152\354\146\324\271\207"
	"\067\133\144\376\077\107\056\063\307\111\176\316\177\202\164\026"
	"\107\000\123\023\107\025\147\064\173\261\046\162\016\306\131\104"
	"\375\052\145\037\131\114\065\266\137\051\324\337\164\350\045\243"
	"\215\032\125\242\324\112\211\306\051\142\320\107\254\234\124\152"
	"\222\216\123\371\071\211\127\056\017\046\017\334\257\136\030\110"
	"\065\033\102\026\020\022\251\236\111\177\314\157\340\145\151\153"
	"\154\130\007\036\203\237\174\303\121\012\154\210\301\004\174\352"
	"\151\233\246\343\044\237\122\131\114\077\003\141\323\230\074\315"
	"\033\232\374\103\236\313\035\155\202\013\376\361\333\327\201\066"
	"\126\173\320\270\117\035\205\307\147\333\170\076\367\114\060\021"
	"\352\257\127\144\122\055\227\312\156\047\251\041\250\362\331\000"
	"\177\150\102\164\377\102\362\252\142\040\354\342\377\264\020\365"
	"\211\260\315\052\101\103\032\304\046\201\222\114\121\356\261\271"
	"\261\026\024\112\214\354\276\205\270\216\211\234\157\316\005\216"
	"\134\066\147\026\054\117\303\142\133\205\177\252\117\201\210\321"
	"\311\206\245\074\266\120\076\300\141\333\046\212\227\226\360\323"
	"\104\160\365\133\062\056\075\137\155\146\332\203\247\012\256\351"
	"\001\041\335\017\066\257\327\261\245\042\071\266\112\066\154\256"
	"\327\016\007\222\241\141\237\073\172\162\274\233\363\126\235\170"
	"\142\241\264\174\173\250\262\154\001\215\123\174\332\311\112\112"
	"\173\312\222\371\355\157\117\200\343\205\031\364\314\003\173\312"
	"\041\226\165\350\150\255\060\047\221\027\044\201\362\306\275\254"
	"\344\374\263\231\230\133\257\006\032\131\212\167\021\366\016\331"
	"\377\363\337\317\256\074\156\116\163\331\223\144\250\321\205\140"
	"\244\336\233\222\232\136\014\262\052\305\222\353\336\071\065\305"
	"\252\041\063\162\301\167\253\043\345\264\050\174\150\331\157\255"
	"\036\227\110\357\247\203\050\234\314\155\150\330\165\317\274\047"
	"\101\204\007\363\305\262\305\046\335\053\245\117\150\023\243\165"
	"\300\044\242\032\077\253\376\304\200\374\033\270\113\372\123\202"
	"\165\155\104\100\067\071\343\063\314\216\310\200\321\114\311\137"
	"\314\254\256\131\304\116\152\054\210\134\374\166\322\254\276\377"
	"\023\171\144\324\151\007\352\311\030\132\126\361\220\144\212\370"
	"\276\023\356\130\377\023\367\100\175\111\064\023\052\151\352\207"
	"\027\344\054\206\224\055\110\311\271\335\025\064\323\026\002\123"
	"\062\032\031\005\240\257\306\304\037\042\275\213\267\357\056\250"
	"\113\306\363\170\116\133\124\362\026\366\012\002\367\301\261\336"
	"\220\141\036\312\326\211\346\125\201\262\341\261\217\073\141\074"
	"\334\045\043\115\330\032\346\310\262\057\203\316\336\252\374\337"
	"\053\256\327\302\161\204\167\252\121\163\226\136\027\235\366\133"
	"\172\100\063\031\227\112\060\137\104\102\173\043\017\306\355\177"
	"\322\260\057\267\355\117\207\231\011\243\230\213\316\213\006\367"
	"\076\062\313\164\122\052\045\352\077\146\122\323\312\222\017\247"
	"\032\126\140\162\145\205\312\202\041\121\356\340\070\270\144\037"
	"\314\331\171\164\176\273\324\350\357\352\005\321\204\323\333\302"
	"\057\201\053\342\127\216\163\354\370\203\253\302\036\001\046\012"
	"\367\215\046\062\045\242\304\125\176\151\025\266\251\146\156\344"
	"\106\115\101\207\317\137\326\220\342\026\241\007\114\374\135\226"
	"\377\044\076\374\375\315\006\330\246\311\315\222\140\303\350\233"
	"\017\311\316\146\102\114\101\241\253\066\044\105\007\142\071\054"
	"\225\170\112\010\230\124\047\114\016\214\205\277\374\016\043\156"
	"\275\032\320\036\166\373\275\037\366\140\043\036\015\076\174\132"
	"\307\364\172\077\277\360\075\273\337\236\074\041\261\010\044\120"
	"\275\266\134\007\060\173\040\134\055\304\264\157\262\335\145\136"
	"\363\147\360\357\256\115\320\250\336\332\363\212\343\033\041\335"
	"\176\166\070\152\202\344\275\343\345\033\077\357\254\210\307\146"
	"\231\244\100\110\217\364\361\041\345\144\147\376\075\313\237\072"
	"\243\342\336\304\066\214\245\321\126\176\017\330\271\353\161\011"
	"\304\231\103\252\064\272\230\211\170\377\346\207\150\352\362\172"
	"\146\220\057\061\047\151\355\100\314\267\212\132\346\301\303\336"
	"\215\154\334\026\232\327\352\245\357\202\305\301\216\045\041\037"
	"\113\247\104\242\142\017\076\036\316\365\002\363\115\161\046\145"
	"\345\015\331\146\101\331\332\113\101\122\174\171\005\337\112\343"
	"\121\360\037\121\110\314\377\344\364\171\266\017\204\131\027\133"
	"\056\015\345\022\233\340\216\141\204\106\154\064\056\010\110\155"
	"\211\020\073\023\227\113\067\327\016\326\345\146\276\301\326\147"
	"\343\022\272\325\106\163\324\363\372\266\211\362\323\106\020\321"
	"\237\355\234\250\224\250\017\124\007\253\251\004\300\163\002\044"
	"\352\140\146\252\076\120\305\112\342\100\375\016\003\256\140\000"
	"\024\306\267\254\140\054\242\027\042\111\301\265\326\006\313\334"
	"\244\236\236\272\051\075\177\277\373\365\005\030\165\351\200\351"
	"\043\050\112\024\007\173\242\243\330\051\073\341\217\267\233\336"
	"\263\301\002\264\111\201\133\266\301\303\064\116\266\253\061\232"
	"\137\155\010\105\134\147\172\272\064\322\162\025\375\353\312\017"
	"\221\210\124\012\260\315\247\055\140\357\043\310\107\376\326\010"
	"\124\174\125\353\160\044\110\052\123\172\347\150\077\245\367\041"
	"\325\322\210\017\353\245\140\246\370\254\242\020\204\070\070\360"
	"\064\313\375\163\077\371\227\147\043\252\167\117\220\212\111\044"
	"\117\024\061\005\301\026\215\071\225\222\274\141\264\107\147\172"
	"\303\255\061\061\141\335\154\154\152\023\233\206\100\243\074\245"
	"\177\105\074\060\261\360\211\256\272\045\035\115\116\052\104\216"
	"\156\250\375\242\363\220\060\031\350\172\014\055\051\131\372\123"
	"\323\362\120\201\322\032\202\365\076\336\240\245\223\343\231\141"
	"\166\331\304\366\162\356\002\377\116\220\050\036\053\357\315\066"
	"\356\105\130\246\113\240\157\316\175\226\021\000\137\316\233\005"
	"\265\022\224\316\305\261\356\236\111\104\070\362\375\330\034\155"
	"\117\334\267\257\212\370\240\102\066\371\070\146\136\051\151\015"
	"\035\145\313\266\361\210\020\012\115\210\304\074\116\241\121\311"
	"\124\126\223\263\252\245\042\243\051\125\130\140\212\210\054\031"
	"\237\137\040\105\107\117\376\140\270\246\360\135\015\122\132\005"
	"\203\232\157\201\005\321\356\327\375\255\110\250\073\167\235\326"
	"\176\077\245\013\167\105\202\051\345\315\372\377\375\104\245\162"
	"\106\014\314\210\125\325\376\164\141\007\153\201\152\251\324\042"
	"\360\316\011\141\324\225\047\115\245\345\007\271\065\315\227\230"
	"\025\262\266\007\310\341\363\202\323\043\035\367\153\345\377\152"
	"\010\364\066\230\044\265\147\336\064\256\142\041\277\063\244\324"
	"\145\147\145\165\054\220\144\332\005\037\032\275\306\142\231\261"
	"\166\101\277\370\270\056\223\071\026\346\033\204\106\366\246\364"
	"\065\254\372\346\350\052\332\174\051\246\263\147\205\015\340\044"
	"\013\106\044\267\230\131\306\352\162\056\121\056\270\157\306\070"
	"\037\040\363\345\200\145\174\013\331\245\345\236\352\162\043\176"
	"\001\070\102\116\362\374\364\230\211\047\154\376\137\155\371\041"
	"\056\273\215\374\350\301\312\353\271\370\174\074\266\155\344\046"
	"\157\035\016\274\106\114\066\303\004\223\263\172\345\241\075\053"
	"\247\305\012\043\264\005\232\270\372\155\006\066\204\105\326\051"
	"\356\147\045\051\322\342\173\001\347\033\131\001\173\334\162\313"
	"\021\213\000\317\006\352\162\165\006\316\206\213\005\315\200\272"
	"\141\021\303\245\304\025\041\057\364\351\377\151\116\222\360\212"
	"\177\052\047\240\325\322\120\335\071\061\236\047\250\100\075\103"
	"\351\330\321\353\020\047\223\243\103\233\325\376\121\236\274\104"
	"\371\334\040\332\156\054\146\075\011\265\366\224\104\045\040\113"
	"\125\152\154\157\062\355\320\250\024\363\230\365\273\357\253\156"
	"\352\257\227\071\327\203\342\253\050\336\167\351\153\251\125\257"
	"\141\212\315\344\216\234\061\274\173\116\170\005\115\036\375\075"
	"\164\213\063\051\032\100\343\017\130\273\104\046\177\203\341\061"
	"\113\276\103\073\171\053\211\315\341\154\275\164\357\153\154\030"
	"\204\146\266\135\126\213\070\144\206\350\014\371\353\030\372\247"
	"\161\105\151\056\047\160\153\224\114\065\245\351\264\347\171\016"
	"\361\335\305\173\076\375\121\264\077\314\347\245\036\244\304\045"
	"\024\115\377\352\062\122\032\116\211\306\017\361\145\231\216\140"
	"\013\356\252\125\004\252\206\174\132\003\034\333\361\224\173\172"
	"\245\250\306\307\324\040\227\274\247\001\132\241\242\270\265\007"
	"\265\121\123\132\243\265\067\035\240\126\224\031\025\175\034\236"
	"\334\356\056\250\147\067\016\271\032\332\315\073\206\305\364\207"
	"\273\250\241\360\170\217\214\311\242\301\000\055\261\160\301\325"
	"\223\202\343\325\215\003\032\203\204\006\315\300\107\215\244\130"
	"\256\016\234\305\333\340\250\141\277\001\355\207\164\103\355\121"
	"\161\202\266\113\261\263\017\100\347\227\170\010\125\241\040\373"
	"\213\125\035\267\377\363\002\237\147\044\341\222\331\343\201\260"
	"\301\057\074\103\251\111\055\371\117\066\206\170\244\225\254\335"
	"\330\326\321\166\356\165\132\016\342\231\312\241\226\275\201\266"
	"\050\206\205\352\300\156\163\231\205\145\063\217\312\031\246\265"
	"\064\353\364\062\254\375\053\054\357\350\035\010\235\251\040\173"
	"\170\212\141\313\011\271\077\350\141\341\317\327\301\130\027\177"
	"\143\255\315\167\250\170\042\176\052\372\340\235\061\167\027\352"
	"\233\146\131\005\332\055\257\001\227\021\035\323\054\251\242\176"
	"\364\075\174\070\326\111\130\125\175\242\013\020\126\011\114\135"
	"\013\063\331\134\046\311\327\320\253\343\111\227\047\074\050\271"
	"\303\305\153\306\300\257\260\005\251\227\100\241\124\267\042\265"
	"\126\033\102\302\130\345\072\125\363\137\172\304\076\112\324\346"
	"\153\311\305\205\071\072\214\173\303\265\175\060\274\331\266\065"
	"\010\043\066\014\006\037\120\334\123\241\133\152\263\331\241\320"
	"\235\174\016\147\335\165\255\002\342\365\161\347\322\262\302\111"
	"\157\217\033\301\105\052\153\052\125\071\250\172\160\247\043\141"
	"\301\122\001\254\270\010\160\001\052\336\041\305\213\274\317\335"
	"\014\246\155\066\124\210\271\211\044\277\022\173\167\354\365\253"
	"\061\306\334\134\376\176\313\232\040\274\364\270\174\061\161\154"
	"\336\361\132\202\014\346\337\123\076\072\354\246\122\303\042\351"
	"\246\110\222\333\040\212\066\155\112\254\037\010\277\135\064\244"
	"\121\110\230\256\333\376\076\104\140\332\201\131\103\127\003\040"
	"\273\106\275\367\000\315\174\055\144\264\217\105\342\352\153\144"
	"\011\004\321\053\301\247\136\013\374\024\302\335\057\353\047\327"
	"\367\346\122\336\014\174\214\040\140\066\375\004\040\275\362\132"
	"\061\235\312\114\334\005\271\045\166\022\344\336\202\313\221\170"
	"\377\057\202\004\014\332\036\367\243\254\211\007\113\200\341\052"
	"\306\315\354\177\207\133\040\055\266\115\247\067\171\331\332\136"
	"\125\310\357\111\372\011\355\022\222\230\355\320\204\261\004\127"
	"\117\047\374\327\202\034\005\071\152\254\160\344\206\112\103\333"
	"\022\062\044\015\074\022\037\317\252\015\240\057\276\244\207\016"
	"\313\203\346\116\237\353\207\012\230\367\356\036\101\061\372\124"
	"\143\036\141\240\060\201\157\333\216\017\012\115\264\221\134\177"
	"\025\102\316\265\056\125\277\306\115\255\344\217\336\337\343\102"
	"\375\104\342\056\306\122\012\125\141\025\242\025\246\376\225\273"
	"\101\143\160\157\270\060\065\006\335\032\225\273\371\171\376\367"
	"\276\340\046\204\062\061\331\224\106\173\252\355\172\077\251\273"
	"\242\032\053\133\112\140\141\047\173\367\343\165\160\341\154\056"
	"\302\223\262\365\304\213\211\012\007\064\367\202\163\241\076\026"
	"\273\151\162\005\311\323\054\105\312\020\272\073\361\047\151\264"
	"\272\034\251\177\250\063\212\257\147\202\062\333\043\160\361\336"
	"\331\143\343\243\067\020\350\002\040\243\075\022\312\247\306\205"
	"\303\157\004\153\242\216\033\012\020\115\345\063\275\326\022\227"
	"\072\365\072\162\005\043\164\046\306\262\070\221\131\376\026\035"
	"\156\032\210\021\251\244\033\272\361\000\356\257\327\000\107\022"
	"\365\202\204\373\245\370\042\154\253\132\375\005\131\023\042\307"
	"\056\252\330\330\117\364\222\101\364\200\360\313\200\070\335\166"
	"\272\142\162\137\133\224\314\006\357\311\013\110\335\055\020\014"
	"\330\351\344\050\335\166\151\322\367\132\236\170\222\174\356\114"
	"\336\140\254\071\365\170\100\344\102\113\055\037\171\076\054\122"
	"\047\020\172\005\207\343\327\177\075\165\367\320\362\345\034\320"
	"\106\311\011\074\102\111\041\204\225\116\244\017\214\320\141\264"
	"\341\334\272\150\300\221\350\376\007\337\316\371\305\353\312\014"
	"\265\324\110\367\036\151\173\263\270\040\303\104\360\045\371\322"
	"\001\263\072\302\105\042\300\115\002\217\107\307\173\021\323\060"
	"\345\034\050\003\205\244\267\076\304\172\203\265\237\174\207\241"
	"\060\302\144\165\345\045\303\347\264\012\256\060\033\202\141\001"
	"\237\211\005\044\055\275\143\361\070\346\246\330\142\055\171\223"
	"\360\335\010\325\002\314\274\267\326\153\350\362\356\111\364\215"
	"\323\371\262\000\267\025\362\357\373\231\307\136\307\101\361\267"
	"\037\371\214\042\306\110\331\234\264\302\217\242\014\203\057\337"
	"\175\341\340\064\366\322\043\362\153\352\120\063\053\101\352\112"
	"\073\167\154\001\300\106\235\164\011\054\026\025\260\106\364\055"
	"\047\324\141\036\247\204\020\023\157\140\106\232\242\061\345\335"
	"\250\122\336\150\231\174\334\242\251\363\267\131\071\254\206\141"
	"\200\347\200\050\154\220\073\333\361\201\166\224\263\134\161\133"
	"\257\120\304\110\314\241\352\165\224\242\317\316\116\125\057\317"
	"\075\257\367\251\100\063\205\062\265\373\306\150\130\070\304\007"
	"\210\210\117\125\051\072\312\275\335\231\214\054\357\273\374\054"
	"\153\364\326\254\047\133\337\334\127\246\105\260\337\011\267\147"
	"\221\007\275\272\102\207\170\037\041\004\114\021\300\110\075\054"
	"\074\024\331\144\157\270\100\307\137\205\167\076\216\056\246\040"
	"\066\143\332\170\353\123\230\015\127\344\036\027\055\134\104\151"
	"\160\035\315\340\326\016\250\065\224\037\164\043\116\032\103\204"
	"\176\036\375\151\161\225\167\310\172\225\340\247\362\044\020\143"
	"\102\336\103\030\355\354\115\202\013\301\245\131\334\351\336\132"
	"\007\333\304\171\160\073\102\352\321\042\222\303\107\243\046\211"
	"\201\152\241\157\126\357\361\142\261\227\274\215\200\232\350\210"
	"\165\255\001\346\350\103\321\271\146\143\175\255\006\244\067\210"
	"\016\330\370\145\307\351\310\171\201\204\007\001\036\357\212\224"
	"\235\213\173\205\317\115\077\065\260\274\342\267\140\031\100\157"
	"\362\070\325\272\042\235\063\244\041\072\245\077\052\057\324\307"
	"\273\117\115\212\234\214\277\115\111\242\005\252\274\106\031\256"
	"\177\357\150\242\214\234\106\255\327\353\355\001\033\302\311\327"
	"\021\027\141\256\244\041\374\355\303\001\230\177\110\261\056\307"
	"\241\227\151\055\063\257\333\012\233\311\014\267\213\326\216\235"
	"\355\360\113\221\022\107\177\325\111\027\125\221\311\204\130\152"
	"\033\302\230\116\161\163\131\015\074\145\304\310\073\123\145\051"
	"\103\260\273\125\370\072\053\102\122\201\324\034\005\054\206\041"
	"\357\037\160\140\222\311\155\317\057\062\227\153\205\374\224\311"
	"\255\120\037\246\212\112\350\335\314\274\371\322\351\177\363\330"
	"\237\143\071\061\055\247\001\135\332\230\310\137\225\135\051\103"
	"\255\110\351\070\223\321\025\137\216\016\061\170\216\045\120\055"
	"\210\212\137\266\062\140\023\014\371\334\153\216\071\225\321\347"
	"\335\273\037\161\215\064\320\033\103\002\224\321\047\345\377\260"
	"\157\136\147\241\276\172\255\270\126\031\107\220\257\030\167\214"
	"\324\226\375\141\312\316\174\016\320\020\337\370\366\336\251\145"
	"\075\020\007\374\212\265\264\341\316\373\161\175\024\350\012\350"
	"\177\010\111\112\326\306\130\247\327\067\240\315\026\111\063\123"
	"\131\072\117\344\357\004\306\276\377\067\074\024\040\107\374\237"
	"\117\106\352\046\015\102\316\344\172\156\262"
#define      msg1_z	65
#define      msg1	((&data[8379]))
	"\345\021\040\065\366\017\071\274\316\071\364\013\276\214\337\204"
	"\201\067\277\207\250\050\352\110\077\076\102\307\246\302\056\277"
	"\374\346\166\376\373\017\242\171\043\027\162\364\352\217\357\075"
	"\321\212\156\266\375\276\046\312\242\333\135\141\026\023\273\126"
	"\355\314\066\336\043\107\024\313\103\030\105\006\362\115\025\122"
	"\112\265\242\220\237\310\236\341\226\202\134\005"
#define      lsto_z	1
#define      lsto	((&data[8459]))
	"\365"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
